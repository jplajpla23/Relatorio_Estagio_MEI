\begin{lstlisting}[caption=Implementação do algoritmo LSE em Javascript,label={JSLSE},language=JavaScript2]
function getPosLSE(d1,d2,d3,d4,n1,n2,n3,n4,scale){
    if(scale==null){
        return -1;
    }

    /*Convert values from String to Float*/
    scale=parseFloat(scale);
    d1=parseFloat(d1);
    d2=parseFloat(d2);
    d3=parseFloat(d3);
    d4=parseFloat(d4);
    
    /*matriz A
        | a  d |
        | b  e |
        | c  f |
    */
    var a=(n2.x)-(n1.x);
    var b=(n3.x)-(n1.x);
    var c=(n4.x)-(n1.x);
    var d=(n2.y)-(n1.y);
    var e=(n3.y)-(n1.y);
    var f=(n4.y)-(n1.y);
    
    /*transposta de A
        | a b c |
        | d e f |
    
        At * a
        | aa bb |
        | cc dd |
        */
    
    var aa=(a*a)+(b*b)+(c*c);
    var bb=(a*d)+(b*e)+(c*f);
    var cc=bb; /*(d*a)+(e*b)+(f*c);*/
    var dd=(d*d)+(e*e)+(f*f);
    
    //determinante de At*A
    
    var det=(aa*dd)-(bb*cc);
    if(det!=0)
    {
        /*pode proceguir ha inversa
    
        inversa
            | aaa  bbb |
            | ccc  ddd |
    
        formula
            | dd/det  -bb/det | 
            | -cc/det  aa/det |
        */
        var aaa=dd/det;
        var bbb=-(bb/det);
        var ccc=-(cc/det);
        var ddd=(aa/det);
    
        // Multiplicar por 1/2
        var aaaa=aaa*0.5;
        var bbbb=bbb*0.5;
        var cccc=ccc*0.5;
        var dddd=ddd*0.5;	
    
        /* multiplicar pela transposta
            | aaaa bbbb |   *  | a b c |
            | cccc dddd |      | d e f |
        */

        var a5=(aaaa*a)+(bbbb*d);
        var b5=(aaaa*b)+(bbbb*e);
        var c5=(aaaa*c)+(bbbb*f);
        var d5=(cccc*a)+(dddd*d);
        var e5=(cccc*b)+(dddd*e);
        var f5=(cccc*c)+(dddd*f);
    
        /* definir b
            | b1 |
            | b2 |
            | b3 |
        */

        var d12=Math.pow((d1*scale),2);
        var b1=Math.pow((n2.x),2) - Math.pow((n1.x),2) + Math.pow((n2.y),2) - Math.pow((n1.y),2) - Math.pow((d2*scale),2) + d12;
        var b2=Math.pow((n3.x),2) - Math.pow((n1.x),2) + Math.pow((n3.y),2) - Math.pow((n1.y),2) - Math.pow((d3*scale),2) + d12;
        var b3=Math.pow((n4.x),2) - Math.pow((n1.x),2) + Math.pow((n4.y),2) - Math.pow((n1.y),2) - Math.pow((d4*scale),2) + d12;
    
    
        /* Multiplicar por b
            | a5 b5 c5 |       *        | b1 |
            | d5 e5 f5 |                | b2 |
                                        | b3 |
        */
        var resX=(a5*b1)+(b5*b2)+(c5*b3);
        var resY=(d5*b1)+(e5*b2)+(f5*b3);
        return {"x":resX,"y":resY};
    }
    return -1;
}
\end{lstlisting}
